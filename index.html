<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Professionele ROI Rekentool voor Nederlandse Holdings - Investeringsanalyse met scenario's, Monte Carlo simulatie en portfolio management">
    <meta name="keywords" content="ROI calculator, investeringsanalyse, holding, Nederland, Monte Carlo, portfolio">
    <title>ROI Rekentool Suite</title>
    
    <!-- Add favicon to prevent 404 error -->
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,">
    
    <!-- Main Stylesheet (imports all modular CSS) -->
    <link rel="stylesheet" href="css/main.css">
    
    <!-- Preload critical resources - PROPERLY FIXED -->
    <link rel="preload" href="js/main.js" as="script" crossorigin>
    <link rel="preload" href="css/main.css" as="style">
    
    <!-- Fallback for older browsers -->
    <script nomodule>
        alert('Deze applicatie vereist een moderne browser met ES6 module support. Update uw browser voor de beste ervaring.');
    </script>
</head>
<body>
    <!-- Error Container -->
    <div id="errorContainer" style="display: none; position: fixed; top: 10px; right: 10px; z-index: 1000;"></div>
    <header>
        <div class="container">
            <h1>ROI Rekentool Suite</h1>
            <p class="subtitle">Professionele Investeringsanalyse</p>
        </div>
    </header>
    
    <div class="container">
        <nav class="tabs" role="navigation" aria-label="Hoofdnavigatie">
            <button class="tab active" data-tab="calculator" aria-selected="true">Basis Calculator</button>
            <button class="tab" data-tab="scenarios" aria-selected="false">Scenario Analyse</button>
            <button class="tab" data-tab="montecarlo" aria-selected="false">Monte Carlo</button>
            <button class="tab" data-tab="waterfall" aria-selected="false">Cashflow Waterfall</button>
            <button class="tab" data-tab="portfolio" aria-selected="false">Multi-Asset Portfolio</button>
            <button class="tab" data-tab="historical" aria-selected="false">Historische Prestaties</button>
            <button class="tab" data-tab="saved" aria-selected="false">Opgeslagen</button>
            <button class="tab" data-tab="export" aria-selected="false">Export</button>
        </nav>
        
        <main class="tab-content">
            <!-- Tab 1: Basis Calculator -->
            <section id="calculator" class="tab-pane active" role="tabpanel">
                <!-- Kapitaal Sectie -->
                <div class="input-section">
                    <h3 class="section-title">üí∞ Kapitaal</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="startKapitaal">Startkapitaal (‚Ç¨)</label>
                            <div class="input-wrapper">
                                <input type="number" id="startKapitaal" min="0" step="1000" aria-describedby="startKapitaal-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="startKapitaal-tooltip">Het eigen vermogen dat u inbrengt bij aanvang van de investering</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Lening Sectie -->
                <div class="input-section">
                    <h3 class="section-title">üè¶ Lening</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="lening">Lening (‚Ç¨)</label>
                            <div class="input-wrapper">
                                <input type="number" id="lening" min="0" step="1000" aria-describedby="lening-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="lening-tooltip">Het geleende bedrag voor leverage. Let op: verhoogt risico maar ook potentieel rendement</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="renteLening">Rente Lening (%)</label>
                            <div class="input-wrapper">
                                <input type="number" id="renteLening" min="0" max="50" step="0.1" aria-describedby="renteLening-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="renteLening-tooltip">Jaarlijkse rente op de lening. Huidige marktrente: 3-5% zakelijk, 4-7% priv√©</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="leningLooptijd">Looptijd Lening (jaren)</label>
                            <div class="input-wrapper">
                                <input type="number" id="leningLooptijd" min="1" max="50" step="1" aria-describedby="leningLooptijd-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="leningLooptijd-tooltip">Periode waarin de lening wordt afgelost</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="aflossingsType">Aflossingstype</label>
                            <div class="input-wrapper">
                                <select id="aflossingsType" aria-describedby="aflossingsType-tooltip">
                                    <option value="lineair">Lineair</option>
                                    <option value="annuitair">Annu√Øtair</option>
                                    <option value="bullet">Bullet (aflossingsvrij)</option>
                                </select>
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="aflossingsType-tooltip">Lineair: gelijke aflossing. Annu√Øtair: gelijke totaalbetaling. Bullet: alleen rente, aflossing aan einde</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Rendement Sectie -->
                <div class="input-section">
                    <h3 class="section-title">üìà Rendement</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="looptijd">Investeringsperiode (jaren)</label>
                            <div class="input-wrapper">
                                <input type="number" id="looptijd" min="1" max="50" step="1" aria-describedby="looptijd-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="looptijd-tooltip">Hoelang u de investering aanhoudt</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="rendementType">Rendement Type</label>
                            <div class="input-wrapper">
                                <select id="rendementType" aria-describedby="rendementType-tooltip">
                                    <option value="vast">Vast percentage</option>
                                    <option value="custom">Aangepast per jaar</option>
                                </select>
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="rendementType-tooltip">Kies vast voor constant rendement of aangepast voor variabel rendement per jaar</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="rendement">Verwacht Rendement (% per jaar)</label>
                            <div class="input-wrapper">
                                <input type="number" id="rendement" min="-100" max="100" step="0.1" aria-describedby="rendement-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="rendement-tooltip">Jaarlijks verwacht rendement op totaal ge√Ønvesteerd vermogen</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="herinvestering">Herinvestering Rendement (%)</label>
                            <div class="input-wrapper">
                                <input type="number" id="herinvestering" min="0" max="100" step="5" aria-describedby="herinvestering-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="herinvestering-tooltip">Percentage van winst dat wordt geherinvesteerd (0-100%)</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="herinvesteringDrempel">Herinvestering Minimumbedrag (‚Ç¨)</label>
                            <div class="input-wrapper">
                                <input type="number" id="herinvesteringDrempel" min="0" step="1000" aria-describedby="herinvesteringDrempel-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="herinvesteringDrempel-tooltip">Minimaal te herinvesteren bedrag. Kleinere bedragen blijven in cash</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Kosten & Belasting Sectie -->
                <div class="input-section">
                    <h3 class="section-title">üí∏ Kosten & Belasting</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="vasteKosten">Vaste Kosten per Jaar (‚Ç¨)</label>
                            <div class="input-wrapper">
                                <input type="number" id="vasteKosten" min="0" step="100" aria-describedby="vasteKosten-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="vasteKosten-tooltip">Jaarlijkse vaste kosten zoals beheer, administratie, accountant</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="belastingType">Belasting Type</label>
                            <div class="input-wrapper">
                                <select id="belastingType" aria-describedby="belastingType-tooltip">
                                    <option value="vpb">Zakelijk (VPB)</option>
                                    <option value="prive">Priv√©</option>
                                </select>
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="belastingType-tooltip">Kies het juiste belastingregime voor uw situatie</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="inflatie">Inflatie (% per jaar)</label>
                            <div class="input-wrapper">
                                <input type="number" id="inflatie" min="0" max="20" step="0.1" aria-describedby="inflatie-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="inflatie-tooltip">Jaarlijkse inflatie voor re√´le waarde berekeningen</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Priv√© Belasting Opties - Verborgen by default -->
                    <div id="priveOptions" class="form-grid" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
                        <div class="form-group">
                            <label for="priveSubType">Priv√© Belasting Methode</label>
                            <div class="input-wrapper">
                                <select id="priveSubType" aria-describedby="priveSubType-tooltip">
                                    <option value="box1">Box 1 - Inkomstenbelasting op winst</option>
                                    <option value="box3">Box 3 - Vermogensbelasting</option>
                                </select>
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="priveSubType-tooltip">Box 1: belasting over daadwerkelijke winst. Box 3: belasting over fictief rendement op vermogen</span>
                            </div>
                        </div>
                        
                        <div class="form-group" id="box1Options">
                            <label for="box1Tarief">Box 1 Tarief (%)</label>
                            <div class="input-wrapper">
                                <input type="number" id="box1Tarief" min="0" max="60" step="0.1" aria-describedby="box1Tarief-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="box1Tarief-tooltip">Uw marginale tarief box 1 (afhankelijk van totaal inkomen)</span>
                            </div>
                        </div>
                        
                        <div class="form-group" id="box3Options" style="display: none;">
                            <label for="box3Rendement">Box 3 Fictief Rendement (%)</label>
                            <div class="input-wrapper">
                                <input type="number" id="box3Rendement" min="0" max="20" step="0.1" aria-describedby="box3Rendement-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="box3Rendement-tooltip">Fictief rendement percentage voor box 3 (2024: 6.04% tot ‚Ç¨57.000, daarna hoger)</span>
                            </div>
                        </div>
            
                        <div class="form-group" id="box3TariefGroup" style="display: none;">
                            <label for="box3Tarief">Box 3 Tarief (%)</label>
                            <div class="input-wrapper">
                                <input type="number" id="box3Tarief" min="0" max="50" step="0.1" aria-describedby="box3Tarief-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="box3Tarief-tooltip">Belastingtarief over fictief rendement box 3 (2024: 31%)</span>
                            </div>
                        </div>
                        
                        <div class="form-group" id="box3VrijstellingGroup" style="display: none;">
                            <label for="box3Vrijstelling">Box 3 Heffingsvrije Voet (‚Ç¨)</label>
                            <div class="input-wrapper">
                                <input type="number" id="box3Vrijstelling" min="0" step="1000" aria-describedby="box3Vrijstelling-tooltip">
                                <span class="tooltip-icon" aria-label="Meer informatie">?</span>
                                <span class="tooltip" id="box3Vrijstelling-tooltip">Heffingsvrije voet box 3 (2024: ‚Ç¨57.000 voor alleenstaanden)</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="inflatie-toggle">
                    <label class="checkbox-label">
                        <input type="checkbox" id="inflatieToggle" checked>
                        <span>Inflatie effecten weergeven</span>
                    </label>
                </div>
                
                <!-- KPIs -->
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <span class="kpi-value" id="kpiROI">0%</span>
                        <span class="kpi-label">ROI</span>
                    </div>
                    <div class="kpi-card">
                        <span class="kpi-value" id="kpiJaarlijksRendement">0%</span>
                        <span class="kpi-label">Jaarlijks Rendement</span>
                    </div>
                    <div class="kpi-card">
                        <span class="kpi-value" id="kpiNettoWinst">‚Ç¨ 0</span>
                        <span class="kpi-label">Netto Winst</span>
                    </div>
                    <div class="kpi-card">
                        <span class="kpi-value" id="kpiCashOnCash">0%</span>
                        <span class="kpi-label">Cash-on-Cash</span>
                    </div>
                    <div class="kpi-card">
                        <span class="kpi-value" id="kpiInflatieImpact">‚Ç¨ 0</span>
                        <span class="kpi-label">Inflatie Impact</span>
                    </div>
                    <div class="kpi-card">
                        <span class="kpi-value" id="kpiLeverageMultiplier">0x</span>
                        <span class="kpi-label">Leverage</span>
                    </div>
                </div>
                
                <!-- Charts Container -->
                <div class="charts-container">
                    <div class="chart-wrapper">
                        <h3>Vermogensontwikkeling</h3>
                        <canvas id="chartVermogen"></canvas>
                    </div>
                    
                    <div class="chart-wrapper">
                        <h3>Cashflow Analyse</h3>
                        <canvas id="chartCashflow"></canvas>
                    </div>
                </div>
                
                <!-- Results Table -->
                <div class="results-section">
                    <h3>Jaar-op-jaar Details</h3>
                    <div class="table-responsive">
                        <table id="resultsTable">
                            <thead>
                                <tr>
                                    <th>Jaar</th>
                                    <th>Vermogen</th>
                                    <th>Re√´le Waarde</th>
                                    <th>Cashflow</th>
                                    <th>ROI</th>
                                    <th>Lening Saldo</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Dynamically populated -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- Other tabs will be loaded here dynamically -->
            <div id="additionalTabs"></div>
        </main>
    </div>
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.js" 
            integrity="sha512-ZwR1/gSZM3ai6vCdI+LVF1zSq/5HznD3ZSTk7kajkaj4D292NLuduDCO1c/NT8Id+jE58KYLKT7hXnbtryGmMg==" 
            crossorigin="anonymous" 
            referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" 
            integrity="sha512-r22gChDnGvBylk90+2e/ycr3RVrDi8DIOkIGNhJlKfuyQM4tIRAI062MaV8sfjQKYVGjOBaZBOA87z+IhZE9DA==" 
            crossorigin="anonymous" 
            referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"
            integrity="sha512-qZvrmS2ekKPF2mSznTQsxqPgnpkI4DNTlrdUmTzrDgektczlKNRRhy5X5AAOnx5S09ydFYWWNSfcEqDTTHgtNA=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"></script>
    
    <!-- Main Application Module - This is the only script tag needed! -->
    <script type="module" src="js/main.js"></script>
</body>
</html>